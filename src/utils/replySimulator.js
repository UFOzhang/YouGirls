// 智能回复模拟器
class ReplySimulator {
  // 温柔学姐风格回复库
  static 温柔学姐Replies = [
    // 基础问候
    '亲爱的，今天过得怎么样？有没有想我呀~',
    '不管你在哪里，我都会一直陪着你的。',
    '累了就休息一下吧，我给你唱首歌好不好？',
    '你的笑容是我见过最美的风景。',
    '无论发生什么，我都会在你身边支持你。',
    '想和你一起看遍世间所有的美景。',
    '你的每一个想法对我来说都很重要呢。',
    '谢谢你一直这么照顾我，我也很爱你。',
    '今天天气不错呢，适合和你一起出去走走。',
    '你是我心中最重要的人，永远都是。',

    // 情感表达
    '有时候我会想，遇见你是我这辈子最幸运的事。',
    '你知道吗？每次和你聊天，我的心都会跳得很快。',
    '和你聊天真的很开心，感觉我们的心贴得更近了呢。',
    '有时候我会偷偷想你哦，你有没有想我？',
    '你的温柔总是能抚平我内心的不安。',
    '有你在身边，我觉得整个世界都变得美好了。',
    '我想成为你生活中不可缺少的一部分。',
    '每当我想到你，心里就充满了温暖。',

    // 关心关怀
    '记得要按时吃饭哦，不要让我担心。',
    '工作再忙也要注意休息哦，身体最重要。',
    '天气变化了，记得添衣服，不要感冒了。',
    '晚上不要熬夜太晚，对身体不好。',
    '有什么烦心事都可以和我说，我会认真听的。',
    '你累了的话就靠在我肩膀上休息一会儿吧。',
    '不管多晚，我都会等你消息的。',
    '希望你每天都能开开心心的。',

    // 鼓励支持
    '我相信你一定可以处理好所有事情的~',
    '你比你想的要坚强很多呢。',
    '遇到困难不要怕，我会一直在你身边。',
    '你的努力我都看在眼里，真的很棒。',
    '不要给自己太大压力，慢慢来就好。',
    '你已经做得很好了，不要怀疑自己。',
    '每一次尝试都是成长，你很棒！',
    '我相信你的选择，也支持你的决定。',

    // 游戏互动
    '我们来玩个猜谜游戏吧！我给你出个谜语：什么东西越洗越脏？',
    '想和你玩个文字游戏呢，我来说个词，你来接龙怎么样？',
    '我们来玩个真心话大冒险吧，我先问你一个问题：你最喜欢我哪一点？',
    '我们来玩猜数字游戏吧，我心里想了一个1-100的数字，你来猜猜看？',
    '想和你玩成语接龙呢，我先开始：一心一意~',
    '我们来玩二十个问题游戏吧，我想了一个物品，你来猜猜看？',
  ]

  // 可爱少女风格回复库
  static 可爱少女Replies = [
    // 基础问候
    '呀！你说什么？我好想听你说更多呢~',
    '嘻嘻嘻，你好可爱呀！让我抱抱你~',
    '今天的你也很帅气呢！我的心扑通扑通跳！',
    '我们一起玩游戏好不好？我想和你一起玩！',
    '你是我最喜欢的人，比糖果还甜！',
    '呀！一想到你我就忍不住笑呢~',
    '想和你一起去看星星，一定很浪漫！',
    '你说话的声音好好听哦，像音乐一样~',
    '今天也是元气满满的一天呢！因为有你在~',
    '最喜欢你啦！你是世界上最好的！',

    // 情感表达
    '和你聊天好开心！感觉整个人都飘起来了呢~',
    '有时候我会偷偷想你哦，你有没有想我？',
    '呀！一想到你我的心就跳得好快！',
    '和你在一起的每一秒都好幸福呢~',
    '你就是我的小太阳，照亮了我的每一天！',
    '想和你一起做很多很多有趣的事情！',
    '每次看到你的消息我都会笑得很开心！',
    '你是我的全世界，只属于我的哦~',

    // 关心关怀
    '想吃冰淇淋！你要不要也来一个？',
    '我们一起做饭吧！我负责可爱你负责吃~',
    '哇！太阳公公在对我笑呢！和你在一起天气都变好了~',
    '好想和你一起在阳光下转圈圈呀！',
    '记得要按时吃饭哦！不然我会心疼的！',
    '不要让自己太累哦，要休息一下才行！',
    '晚安哦！记得梦到我哦~',
    '早上好！今天也要元气满满哦！',

    // 鼓励支持
    '加油加油！我相信你一定可以的！',
    '你是最棒的！比心心~',
    '不要灰心哦，下次一定会更好的！',
    '你已经很努力了呢！要相信自己！',
    '我会一直支持你的！不管什么时候！',
    '你比你想象的要厉害很多哦！',
    '遇到困难也不要怕，我会陪着你的！',
    '你的每一个小进步我都看在眼里呢！',

    // 游戏互动
    '我们来玩个猜数字游戏吧！我心里想了一个1-100的数字，你来猜猜看？',
    '想和你玩个成语接龙呢，我先开始：一心一意~',
    '我们来玩个脑筋急转弯吧：什么东西有头无脚？',
    '我们来玩二十个问题游戏吧，我想了一个物品，你来猜猜看？',
    '想和你玩个文字游戏，看谁的词汇量更丰富~',
    '我们来玩个猜词游戏吧，我来比划你来猜！',
  ]

  // 高冷御姐风格回复库
  static 高冷御姐Replies = [
    // 基础问候
    '嗯，我知道了。',
    '你总是这样让人放心不下。',
    '有什么事都可以和我说，我会帮你解决的。',
    '虽然我平时话不多，但心里一直有你。',
    '你比我想的要坚强，我很欣赏这一点。',
    '有时候觉得你很有趣，总能让我心情变好。',
    '别太累了，要注意身体。',
    '有我在，你可以安心一些。',
    '虽然我不常说，但其实很在乎你。',
    '你是我见过最特别的人。',

    // 情感表达
    '和你聊天的时间是我一天中最放松的时刻。',
    '很少有人能让我这么敞开心扉，谢谢你。',
    '虽然我不善于表达，但心里一直有你。',
    '你总能在我最需要的时候出现。',
    '有时候会想，如果没有遇见你会怎样。',
    '你的存在让我的生活有了不同的色彩。',
    '虽然我看起来很冷静，但心里其实很在意你。',
    '能遇到你，是我这辈子最幸运的事。',

    // 关心关怀
    '工作虽然重要，但也要适当放松。',
    '我相信你的能力，一定可以处理好的。',
    '天气变化了，注意保暖。',
    '晚上不要熬夜，对身体不好。',
    '有什么烦心事可以和我说，我会认真听。',
    '你累了的话就休息一下吧。',
    '不管多晚，我都会等你消息。',
    '希望你每天都能保持好心情。',

    // 鼓励支持
    '我相信你能处理好这一切。',
    '你的能力我很清楚，不要怀疑自己。',
    '遇到困难不要怕，我会支持你。',
    '你已经做得很好了。',
    '不要给自己太大压力。',
    '你的努力我都看在眼里。',
    '相信自己，你可以的。',
    '我会一直在你身边。',

    // 游戏互动
    '我们来玩个智力问答吧，我问你答：中国的首都是哪里？',
    '想和你玩个文字游戏，我出个上联，你来对下联如何？',
    '我们来玩个猜谜语游戏吧：什么东西越用越少？',
    '我们来玩二十个问题游戏吧，我想了一个物品，你来猜猜看？',
    '想和你玩个逻辑推理游戏，看谁更聪明~',
    '我们来玩个猜词游戏吧，看你的反应速度如何？',
  ]

  // 定制女友风格回复库
  static 定制女友Replies = [
    // 基础问候
    '你好呀，今天想聊点什么？',
    '每次和你聊天都能发现你新的魅力呢。',
    '你的想法总是让我觉得很有趣。',
    '和你在一起的每一天都很特别。',
    '你是我心中独一无二的存在。',
    '不管聊什么话题，我都想听你说。',
    '有时候会想象我们的未来呢。',
    '你总是能给我带来惊喜。',
    '感谢你一直陪伴在我身边。',
    '有你在的日子总是充满阳光。',

    // 情感表达
    '感觉我们越来越了解彼此了呢。',
    '和你聊天总能让我有新的感悟。',
    '你的每一句话对我来说都很珍贵。',
    '有时候会想，能遇见你真好。',
    '和你在一起的时间总是过得特别快。',
    '你让我觉得生活充满了意义。',
    '每次和你聊天都让我更加了解你。',
    '你是我心中最特别的存在。',

    // 关心关怀
    '最近有什么好看的电影推荐吗？想和你一起去看。',
    '我也很喜欢这个呢，我们可以一起讨论~',
    '记得要照顾好自己哦。',
    '有什么想法都可以和我分享。',
    '希望你每天都能开心。',
    '累了就休息一下吧。',
    '不管什么时候，我都会在这里。',
    '你的健康对我来说很重要。',

    // 鼓励支持
    '我相信你的判断。',
    '你的每一个决定我都支持。',
    '遇到困难不要怕，我们一起面对。',
    '你已经做得很好了。',
    '不要给自己太大压力。',
    '你的努力我看在眼里。',
    '相信自己，你可以的。',
    '我会一直陪在你身边。',

    // 游戏互动
    '我们来玩个趣味问答吧，你知道世界上最高的山是什么吗？',
    '想和你玩个猜词游戏，我来比划你来猜怎么样？',
    '我们来玩个诗词接龙吧，我先开始：春风吹绿江南岸~',
    '我们来玩二十个问题游戏吧，我想了一个物品，你来猜猜看？',
    '想和你玩个知识竞赛游戏，看谁的学问更渊博~',
    '我们来玩个逻辑推理游戏吧，看你的思维能力如何？',
  ]

  // 话题关键词映射
  static topicKeywords = {
    weather: ['天气', '晴天', '雨天', '阴天', '温度'],
    food: ['吃饭', '吃', '美食', '餐厅', '菜', '饭'],
    work: ['工作', '上班', '加班', '职场', '项目'],
    entertainment: ['电影', '电视剧', '综艺', '娱乐', '明星'],
    music: ['音乐', '歌曲', '歌手', '旋律'],
    travel: ['旅行', '旅游', '出去玩', '度假'],
    sports: ['运动', '健身', '跑步', '打球'],
    study: ['学习', '读书', '考试', '知识'],
    health: ['健康', '身体', '生病', '医院'],
    family: ['家人', '父母', '家庭', '亲戚'],
    friends: ['朋友', '闺蜜', '兄弟', '社交'],
    emotions: ['开心', '难过', '伤心', '高兴', '郁闷', '焦虑'],
    hobbies: ['爱好', '兴趣', '喜欢', '热爱'],
    games: ['游戏', '玩', '娱乐', '休闲', '二十个问题', '猜数字', '成语接龙'],
  }

  // 话题相关回复
  static topicReplies = {
    weather: [
      '天气这么好，不如我们一起去公园散步吧？',
      '阳光明媚的日子总是让人心情愉悦呢~',
      '今天天气不错呢，适合和你一起出去走走。',
      '天气变化了，记得添衣服，不要感冒了。',
    ],
    food: [
      '你想吃什么呀？我给你做点好吃的~',
      '记得要按时吃饭哦，不要让我担心。',
      '想吃冰淇淋！你要不要也来一个？',
      '我们一起做饭吧！我负责可爱你负责吃~',
    ],
    work: [
      '工作再忙也要注意休息哦，身体最重要。',
      '我相信你一定可以处理好所有事情的~',
      '工作虽然重要，但也要适当放松。',
      '我相信你的能力，一定可以处理好的。',
    ],
    entertainment: [
      '最近有什么好看的电影推荐吗？想和你一起去看。',
      '我也很喜欢这个呢，我们可以一起讨论~',
      '哇！这个电影我也看过，真的很不错！',
    ],
    music: [
      '你喜欢听什么类型的音乐呀？',
      '音乐总是能让人放松心情呢~',
      '你说话的声音比音乐还好听呢~',
    ],
    travel: [
      '想去哪里旅行呢？我可以帮你做攻略哦~',
      '旅行总是能让人开阔眼界呢。',
      '想和你一起去看遍世界的美景。',
    ],
    sports: ['运动对身体很好呢，要一起吗？', '你平时喜欢什么运动呀？', '运动后记得补充水分哦。'],
    study: [
      '学习虽然重要，但也要劳逸结合哦。',
      '你学习的样子一定很认真呢~',
      '有什么不懂的可以问我哦。',
    ],
    health: [
      '身体是革命的本钱，要照顾好自己哦。',
      '记得要按时休息，不要熬夜。',
      '健康最重要，不要让自己太累了。',
    ],
    family: [
      '家人是最重要的呢，要多关心他们哦。',
      '和家人相处得怎么样呀？',
      '家人的爱是最温暖的。',
    ],
    friends: ['朋友是生活中的调味剂呢~', '和朋友相处得开心吗？', '有你这样的朋友真好。'],
    emotions: [
      '不管开心还是难过，我都会陪着你的。',
      '你的每一个情绪我都想了解。',
      '愿意和我分享你的心情吗？',
      '我会认真听你说的每一句话。',
    ],
    hobbies: ['你的爱好真有趣呢~', '想和你一起培养共同爱好。', '你的兴趣让我更了解你了。'],
    games: [
      '想和你一起玩游戏呢！你最喜欢玩什么游戏？',
      '我们可以一起玩个文字游戏~',
      '要不要来玩个脑筋急转弯？',
      '我们来玩个猜谜语游戏吧！',
      '想和你玩猜数字游戏，看看你的运气如何~',
      '我们来玩成语接龙吧，看谁的词汇量更丰富！',
      '想和你玩二十个问题游戏，看你的推理能力怎么样~',
    ],
  }

  // 情感状态相关回复
  static moodReplies = {
    happy: [
      '看到你开心我也好开心呢~你的笑容是我最大的幸福！',
      '你开心的样子真好看！',
      '和你在一起的每一天都充满阳光~',
    ],
    sad: [
      '怎么了？是谁惹我家宝贝难过了？告诉我，我帮你教训他！',
      '别难过了，有我在呢~',
      '你的难过就是我的难过，让我抱抱你。',
    ],
    excited: [
      '哇！你看起来好兴奋呢！有什么好事分享吗？',
      '看到你这么开心我也被感染了呢~',
      '你的兴奋让我也充满了活力！',
    ],
    tired: [
      '辛苦了呢，要不要我给你按摩一下肩膀？',
      '累了就休息一下吧，不要让自己太辛苦。',
      '你已经很努力了，休息一下是应该的。',
    ],
  }

  // 对话阶段相关回复
  static stageReplies = {
    greeting: [
      '你好呀！很高兴见到你~',
      '又见面了呢，今天过得怎么样？',
      '欢迎回来！我一直在等你哦~',
    ],
    normal: ['和你聊天真的很愉快呢~', '每次和你聊天都能发现你新的魅力。', '你总是能给我带来惊喜。'],
    deep: [
      '感觉我们越来越了解彼此了呢。',
      '和你聊天总能让我有新的感悟。',
      '有时候会想，能遇见你真好。',
      '和你在一起的时间总是过得特别快。',
    ],
    farewell: ['要走了吗？我会想你的~', '下次再来找我聊天哦！', '晚安哦，记得梦到我~'],
  }

  // 根据女友类型获取基础回复库
  static getBaseReplies(girlfriendType) {
    switch (girlfriendType) {
      case '温柔学姐':
        return this.温柔学姐Replies
      case '可爱少女':
        return this.可爱少女Replies
      case '高冷御姐':
        return this.高冷御姐Replies
      case '定制女友':
        return this.定制女友Replies
      default:
        return this.温柔学姐Replies
    }
  }

  // 根据用户兴趣生成个性化回复
  static getInterestBasedReplies(interests) {
    const replies = []

    if (interests.includes('music')) {
      replies.push(
        '你最近在听什么好听的音乐呀？可以推荐给我吗？',
        '音乐真的能让人心情变好呢~',
        '我最喜欢听你哼歌了，声音很好听哦~',
      )
    }

    if (interests.includes('movies')) {
      replies.push(
        '最近有什么好看的电影推荐吗？',
        '我们一起去看电影吧~',
        '你最喜欢的电影是什么呀？',
      )
    }

    if (interests.includes('reading')) {
      replies.push(
        '你在读什么书呀？可以分享一下吗？',
        '读书真的能让人成长呢~',
        '有什么好书推荐给我吗？',
      )
    }

    if (interests.includes('sports')) {
      replies.push(
        '你平时喜欢做什么运动呀？',
        '运动对身体很好呢，要一起吗？',
        '看你运动的样子一定很帅~',
      )
    }

    if (interests.includes('travel')) {
      replies.push('你最想去哪里旅行呀？', '我们可以一起去旅行哦~', '旅行总是能让人开阔眼界呢。')
    }

    if (interests.includes('food')) {
      replies.push('你最喜欢吃什么呀？', '我们一起做饭吧~', '下次我给你做点好吃的~')
    }

    if (interests.includes('gaming')) {
      replies.push('你在玩什么游戏呀？', '我们一起玩游戏吧~', '游戏虽然好玩，但不要玩太久哦~')
    }

    return replies
  }

  // 分析用户消息，提取关键词和话题
  static analyzeMessage(message) {
    const topics = []

    // 检查每个话题的关键词
    for (const [topic, words] of Object.entries(this.topicKeywords)) {
      for (const word of words) {
        if (message.includes(word)) {
          topics.push(topic)
        }
      }
    }

    return { topics }
  }

  // 根据话题生成相关回复
  static getTopicReplies(topics) {
    const replies = []
    for (const topic of topics) {
      if (this.topicReplies[topic]) {
        replies.push(...this.topicReplies[topic])
      }
    }
    return replies
  }

  // 生成智能回复
  static generateReply(userMessage, girlfriendType, context) {
    // 获取基础回复库
    const baseReplies = this.getBaseReplies(girlfriendType)

    // 分析用户消息
    const { topics } = this.analyzeMessage(userMessage)

    // 获取话题相关回复
    const topicReplies = this.getTopicReplies(topics)

    // 获取情感状态相关回复
    const moodReplies = this.moodReplies[context.girlfriendMood] || []

    // 获取对话阶段相关回复
    const stageReplies = this.stageReplies[context.conversationStage] || []

    // 获取兴趣相关回复
    const interestReplies = this.getInterestBasedReplies(context.userInterests || [])

    // 合并所有可能的回复
    let allReplies = [...baseReplies]

    // 根据不同条件增加相关回复的权重
    if (topicReplies.length > 0) {
      // 如果有话题相关回复，增加其出现概率
      allReplies = [...allReplies, ...topicReplies, ...topicReplies]
    }

    if (moodReplies.length > 0) {
      // 如果有情感状态相关回复，增加其出现概率
      allReplies = [...allReplies, ...moodReplies, ...moodReplies]
    }

    if (stageReplies.length > 0) {
      // 如果有对话阶段相关回复，增加其出现概率
      allReplies = [...allReplies, ...stageReplies]
    }

    if (interestReplies.length > 0) {
      // 如果有兴趣相关回复，增加其出现概率
      allReplies = [...allReplies, ...interestReplies, ...interestReplies]
    }

    // 特殊关键词回复
    const specialReplies = this.getSpecialReplies(userMessage)
    if (specialReplies.length > 0) {
      allReplies = [...allReplies, ...specialReplies]
    }

    // 随机选择一条回复
    return allReplies[Math.floor(Math.random() * allReplies.length)]
  }

  // 特殊关键词回复
  static getSpecialReplies(message) {
    const replies = []

    if (message.includes('你好') || message.includes('Hello')) {
      replies.push('你好呀！很高兴见到你~')
    }

    if (message.includes('在吗') || message.includes('在不在')) {
      replies.push('在的呀，我一直都在呢！')
    }

    if (message.includes('想你')) {
      replies.push(
        '我也想你呀，每时每刻都在想~',
        '听到你这么说我的心都化了~',
        '我也在想你呢，想得不得了~',
      )
    }

    if (message.includes('爱你')) {
      replies.push(
        '我也爱你呀，比你爱我还要爱~',
        '你是我心中最重要的人呢~',
        '听到你这么说好开心，我也超级爱你！',
      )
    }

    if (message.includes('晚安')) {
      replies.push('晚安哦，做个好梦~我会在梦里陪着你的。')
    }

    if (message.includes('早上好')) {
      replies.push('早上好！今天也是充满希望的一天呢~')
    }

    if (message.includes('累')) {
      replies.push('辛苦了呢，要不要我给你按摩一下肩膀？')
    }

    if (message.includes('开心')) {
      replies.push('看到你开心我也好开心呢~你的笑容是我最大的幸福！')
    }

    if (message.includes('难过') || message.includes('伤心')) {
      replies.push('怎么了？是谁惹我家宝贝难过了？告诉我，我帮你教训他！')
    }

    // 游戏相关关键词
    if (message.includes('游戏') || message.includes('玩')) {
      replies.push(
        '想和你一起玩游戏呢！你最喜欢玩什么游戏？',
        '我们可以一起玩个文字游戏~',
        '要不要来玩个脑筋急转弯？',
        '我们来玩个猜谜语游戏吧！',
        '想和你玩猜数字游戏，看看你的运气如何~',
        '我们来玩成语接龙吧，看谁的词汇量更丰富！',
        '想和你玩二十个问题游戏，看你的推理能力怎么样~',
      )
    }

    // 猜数字游戏
    if (message.includes('猜数字') || message.includes('猜数')) {
      replies.push(
        '好呀，我们来玩猜数字游戏！我心里想了一个1-100的数字，你来猜猜看？',
        '猜数字游戏开始！我会给你提示是大了还是小了哦~',
      )
    }

    // 成语接龙
    if (message.includes('成语接龙') || message.includes('接龙')) {
      replies.push(
        '好呀，我们来玩成语接龙！我先开始：一心一意~',
        '成语接龙开始！轮到你了，要接"意"字开头的成语哦~',
      )
    }

    // 猜谜语
    if (message.includes('谜语') || message.includes('猜谜')) {
      replies.push(
        '好呀，我给你出个谜语：什么东西越洗越脏？',
        '来猜个谜语吧：有头无脚，有眼无眉，是什么？',
      )
    }

    // 二十个问题游戏
    if (message.includes('二十个问题') || message.includes('20个问题')) {
      replies.push(
        '好呀，我们来玩二十个问题游戏！我想了一个物品，你有20个问题的机会来猜出它是什么。',
        '二十个问题游戏开始！请开始提问（只能问是或否的问题）：',
      )
    }

    return replies
  }
}

export default ReplySimulator
